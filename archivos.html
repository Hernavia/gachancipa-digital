<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Archivos — Gachancipá</title>
<link rel="stylesheet" href="style.css">
<style>
/* Acordeón estilo bloque resumen */
.accordion-title {
  cursor: pointer;
  background-color: #f0f0f0;
  border: 1px solid #000;
  padding: 8px;
  width: 100%;
  text-align: left;
  margin-top: 5px;
  font-weight: bold;
}
.accordion-title:after {
  content: '\002B';
  float: right;
}
.accordion-title.active:after {
  content: '\2212';
}
.accordion-content {
  display: none;
  padding: 8px;
  border: 1px solid #000;
  border-top: none;
  margin-bottom: 5px;
}

/* Buscador estilo original */
.search-container {
  margin-left: auto;
}
#searchInput {
  padding: 5px;
  width: 180px;
}
#searchResults {
  position: absolute;
  background: #fff;
  border: 1px solid #000;
  max-height: 200px;
  overflow-y: auto;
  width: 180px;
}
</style>
</head>
<body>
<header>
  <h1>Archivos Municipales</h1>
  <div class="header-box"><p>Repositorio público de Gachancipá</p></div>
</header>

<nav class="navbar">
  <ul>
    <li><a href="https://hernavia.github.io/gachancipa-digital/">Inicio</a></li>
    <li><a href="archivos.html" class="active">Archivos</a></li>
    <li><a href="calendario.html">Calendario</a></li>
    <li><a href="educacion.html">Educación</a></li>
    <li><a href="cronicas.html">Crónicas</a></li>
    <li><a href="proyectos.html">Proyectos</a></li>
    <li><a href="llamados.html">Llamados al Pueblo</a></li>
    <li><a href="wikigacha.html">Enciclopedia Gachancipeña</a></li>
  </ul>
  <div class="search-container">
    <input type="text" id="searchInput" placeholder="Buscar...">
    <div id="searchResults"></div>
  </div>
</nav>

<main class="archivos-container" id="archivosApp">

  <section class="search-controls">
    <div class="filtros">
      <label for="dateFrom">Desde</label>
      <input type="date" id="dateFrom" style="width:180px;">
      <label for="dateTo">Hasta</label>
      <input type="date" id="dateTo" style="width:180px;">
      <button id="btnFilter" class="filter-btn">Filtrar</button>
      <button id="btnClear" class="clear-btn">Limpiar</button>
    </div>
    <div class="result-count" id="resultCount">Mostrando todas las noticias</div>
  </section>

  <article class="archivo-mes" data-month="2025-10">
    <h2>Octubre 2025</h2>

    <!-- Archivo largo normal -->
    <div class="archivo-item" data-type="larga" data-date="2025-10-18" data-keywords="acta consejo cultura feria empresarial" tabindex="0">
      <h4>Acta 120: Feria Empresarial y espacio de Yukiherts</h4>
      <p class="meta">Alcaldía — 18/10/2025 — Documentos oficiales</p>
      <p>Se habilitó un espacio para la feria empresarial donde participará Yukiherts.</p>
      <a class="btn-ver" href="https://hernavia.github.io/gachancipa-digital/archivos.html">Ver Página</a>
    </div>

    <!-- Acordeón como bloque resumen -->
    <div class="archivo-item" data-type="corta" data-date="2025-10-18" data-keywords="servicios agua corte" tabindex="0">
      <div class="accordion-title">Compañía eléctrica: aviso de corte</div>
      <div class="accordion-content">
        <p class="meta">Servicios Públicos — 18/10/2025</p>
        <p>Habrá suspensión del servicio entre las 8:00 y 14:00 por mantenimiento de la red eléctrica. Se recomienda a la comunidad tomar precauciones.</p>
      </div>
    </div>

    <div class="archivo-item" data-type="corta" data-date="2025-10-10" data-keywords="junta accion comunal convocatoria" tabindex="0">
      <div class="accordion-title">Reunión de Junta de Acción Comunal</div>
      <div class="accordion-content">
        <p class="meta">Comunidad — 10/10/2025</p>
        <p>Todos los presidentes de JAC locales están invitados a la reunión del próximo martes a las 7:00 pm en el salón comunal.</p>
      </div>
    </div>

    <!-- Otro archivo largo normal -->
    <div class="archivo-item" data-type="larga" data-date="2025-10-10" data-keywords="educacion convocatoria talleres" tabindex="0">
      <h4>Convocatoria: Talleres de educación cívica</h4>
      <p class="meta">Educación — 10/10/2025</p>
      <p>Se abren inscripciones para talleres dirigidos a colegios y líderes comunitarios.</p>
      <a class="btn-ver" href="https://hernavia.github.io/gachancipa-digital/archivos.html">Ver Página</a>
    </div>

  </article>
</main>

<footer>
  <p>©2025 — Archivos Municipales de Gachancipá</p>
</footer>

<script>
// Filtrado por rango de fechas
const btnFilter = document.getElementById('btnFilter');
const btnClear = document.getElementById('btnClear');
const dateFrom = document.getElementById('dateFrom');
const dateTo = document.getElementById('dateTo');
const items = Array.from(document.querySelectorAll('.archivo-item'));
const resultCount = document.getElementById('resultCount');

function formatCount(n){return n===0?'No hay resultados':n===1?'1 resultado':n+' resultados';}

function applyFilters(){
  const from = dateFrom.value;
  const to = dateTo.value;
  let visible = 0;

  items.forEach(it=>{
    const date = it.dataset.date;
    let show = true;
    if(from && date < from) show = false;
    if(to && date > to) show = false;
    it.style.display = show ? 'block' : 'none';
    visible += show ? 1 : 0;
  });

  resultCount.textContent = formatCount(visible);
}

btnFilter.addEventListener('click', e=>{
  e.preventDefault();
  applyFilters();
});

btnClear.addEventListener('click', e=>{
  e.preventDefault();
  dateFrom.value = '';
  dateTo.value = '';
  applyFilters();
});

// Acordeones dentro del mismo bloque
const accordionTitles = document.querySelectorAll('.accordion-title');
accordionTitles.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    btn.classList.toggle('active');
    const content = btn.nextElementSibling;
    content.style.display = content.style.display === 'block' ? 'none' : 'block';
  });
});

// Barra de búsqueda (solo filtra por keywords y título)
const searchInput = document.getElementById('searchInput');
const searchResults = document.getElementById('searchResults');

searchInput.addEventListener('input', ()=>{
  const query = searchInput.value.toLowerCase();
  searchResults.innerHTML = '';
  if(query.length === 0) return;

  const matches = items.filter(it=>{
    return it.dataset.keywords.toLowerCase().includes(query) || 
           (it.querySelector('h4') && it.querySelector('h4').textContent.toLowerCase().includes(query)) ||
           (it.querySelector('.accordion-title') && it.querySelector('.accordion-title').textContent.toLowerCase().includes(query));
  });

  matches.forEach(it=>{
    const div = document.createElement('div');
    div.textContent = it.querySelector('h4') ? it.querySelector('h4').textContent : it.querySelector('.accordion-title').textContent;
    div.style.cursor = 'pointer';
    div.addEventListener('click', ()=>{
      it.scrollIntoView({behavior: 'smooth'});
      it.style.border = '2px solid #006a44';
    });
    searchResults.appendChild(div);
  });
});
</script>
</body>
</html>
